{% liquid
  assign default_subscribe_link = routes.all_products_collection_url
  if settings.subscription_product != blank
    assign default_subscribe_link = settings.subscription_product.url
  elsif settings.subscription_fallback_link != blank
    assign default_subscribe_link = settings.subscription_fallback_link
  elsif collections['all'] != blank and collections['all'].products_count > 0
    assign first_product = collections['all'].products | first
    if first_product != blank
      assign default_subscribe_link = first_product.url
    endif
  endif

  assign primary_label = section.settings.primary_cta_label
  assign primary_link = section.settings.primary_cta_link
  if primary_link == blank
    assign primary_link = default_subscribe_link
  endif

  if settings.prelaunch_mode
    assign primary_label = section.settings.waitlist_cta_label
    if settings.waitlist_link != blank
      assign primary_link = settings.waitlist_link
    else
      assign primary_link = section.settings.waitlist_cta_link
    endif
  endif
%}

<section class="section-shell">
  <div class="page-width hero reveal">
    <div class="hero__copy">
      <span class="eyebrow">{{ section.settings.eyebrow }}</span>
      <h1>{{ section.settings.heading }}</h1>
      <p class="text-muted">{{ section.settings.subheading }}</p>

      {% if settings.prelaunch_mode and settings.founder_batch_text != blank %}
        <p class="badge" style="margin-top: 1rem;">{{ settings.founder_batch_text }}</p>
      {% endif %}

      <div class="hero__actions">
        <a class="btn" href="{{ primary_link }}">{{ primary_label }}</a>
        {% unless settings.prelaunch_mode %}
          <a class="btn btn--secondary" href="{{ section.settings.waitlist_cta_link | default: settings.waitlist_link }}">{{ section.settings.waitlist_cta_label }}</a>
        {% endunless %}
      </div>

      <div class="trust-inline" aria-label="Señales de confianza">
        {% for block in section.blocks %}
          <span class="trust-inline__item" {{ block.shopify_attributes }}>{{ block.settings.text }}</span>
        {% endfor %}
      </div>
    </div>

    <div>
      {% if section.settings.hero_image != blank %}
        {{ section.settings.hero_image | image_url: width: 1200 | image_tag: widths: '560,760,960,1200', class: 'card', loading: 'eager', alt: section.settings.hero_image_alt }}
      {% else %}
        <div class="media-placeholder">
          <span>Dirección de arte: plano cenital, especias en macro, luz cálida natural y packaging premium.</span>
        </div>
      {% endif %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Hero suscripción",
  "settings": [
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow",
      "default": "Suscripción mensual"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Titular",
      "default": "Viaja por el mundo desde tu cocina."
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subtitular",
      "default": "Cada mes: 3 blends de especias + recetas + video QR. Listo en 20-30 minutos."
    },
    {
      "type": "text",
      "id": "primary_cta_label",
      "label": "Texto CTA principal",
      "default": "Comenzar suscripción"
    },
    {
      "type": "url",
      "id": "primary_cta_link",
      "label": "Enlace CTA principal"
    },
    {
      "type": "text",
      "id": "waitlist_cta_label",
      "label": "Texto CTA lista de espera",
      "default": "Unirme a la lista"
    },
    {
      "type": "url",
      "id": "waitlist_cta_link",
      "label": "Enlace CTA lista de espera"
    },
    {
      "type": "image_picker",
      "id": "hero_image",
      "label": "Imagen hero"
    },
    {
      "type": "text",
      "id": "hero_image_alt",
      "label": "Alt imagen hero",
      "default": "Especias y receta sobre mesa de cocina"
    }
  ],
  "blocks": [
    {
      "type": "trust",
      "name": "Sello de confianza",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Texto",
          "default": "Envío mensual"
        }
      ]
    }
  ],
  "max_blocks": 4,
  "presets": [
    {
      "name": "Hero suscripción",
      "blocks": [
        { "type": "trust", "settings": { "text": "Envío mensual" } },
        { "type": "trust", "settings": { "text": "Cancela cuando quieras" } },
        { "type": "trust", "settings": { "text": "Drops estacionales limitados" } }
      ]
    }
  ]
}
{% endschema %}
